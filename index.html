<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ROM — Everyday AI</title>
  <meta name="description" content="ROM — organize your life from messages, files, reminders into smart cards. Local‑first, no servers." />
  <style>
    :root{
      --bg:#FFFFFF; --panel:#FFFFFF; --surface:#FFFFFF; --surface-2:#F6F7FB; --stroke:#E8EDF4;
      --ink:#0B1220; --muted:#667085; --accent:#0A84FF; --accent-2:#6AA3FF;
      --green:#2ECC71; --orange:#FF9F0A; --red:#EF4444; --purple:#6B5BCE; --blue:#0A84FF; --gray:#98A2B3;
      --radius:16px; --shadow:0 10px 28px rgba(15,17,22,0.10);
      --fs-xs:12px; --fs-s:14px; --fs-m:16px; --fs-l:20px; --fs-xl:28px; --fs-xxl:36px;
    }
    <!-- CONNECTORS -->
<section class="rom-card" id="connectors">
<h3>Connect Apps</h3>
<p class="muted">Authenticate once. Data stays private; you control actions.</p>
<div class="btnrow">
<button id="btn-google">Google Calendar</button>
<button id="btn-slack">Slack</button>
<button id="btn-sms">SMS</button>
</div>
<div id="connect-status" class="status"></div>
</section>


<!-- DAILY DIGEST + ACTIONS -->
<section class="rom-card" id="daily-digest">
<h3>Today’s Catch‑Up</h3>
<div id="digest-stats" class="muted">Loading…</div>
<ul id="digest-items" class="list"></ul>
<div id="digest-actions" class="btnrow"></div>
</section>

<!-- MULTI‑LLM CHAT -->
<section class="rom-card" id="ai-chat">
<h3>ROM Chat</h3>
<div class="chat-toolbar">
<label>Model
<select id="model">
<option value="openai:gpt-4o-mini">OpenAI — gpt‑4o‑mini</option>
<option value="gemini:1.5-pro">Gemini — 1.5‑pro</option>
<option value="anthropic:claude-3-haiku">Anthropic — Claude 3 Haiku</option>
</select>
</label>
<label>Persona
<select id="persona">
<option value="neutral">Neutral</option>
<option value="zodiac">As my zodiac sign</option>
<option value="athlete">As my favorite athlete</option>
<option value="founder">Startup founder tone</option>
</select>
</label>
</div>
<div class="chat-box" id="chat-box"></div>
<div class="chat-input">
<input id="prompt" placeholder="Ask ROM…" />
<button id="send">Send</button>
</div>
</section>

    *{box-sizing:border-box}
    body{margin:0;color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg)}
    body::before{content:""; position:fixed; inset:0; z-index:-1; background:
      radial-gradient(circle at 20% 20%, rgba(234, 242, 255, 0.8) 0%, transparent 50%),
      radial-gradient(circle at 80% 10%, rgba(255, 234, 242, 0.6) 0%, transparent 50%),
      radial-gradient(circle at 60% 90%, rgba(240, 245, 255, 0.4) 0%, transparent 50%),
      linear-gradient(135deg, #FFFFFF 0%, #F8FAFF 40%, #F0F5FF 70%, #FFFFFF 100%);
    }
    .container{max-width:1120px;margin:0 auto;padding:24px}
    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .brand{font-weight:800;font-size:18px;letter-spacing:.4px}
    .actions{display:flex;gap:8px}
    .btn{padding:10px 16px;border-radius:12px;border:1px solid var(--stroke);background:#fff;cursor:pointer;transition:transform .06s ease, box-shadow .2s, border-color .2s; font-size:14px; color:var(--ink); display:inline-flex; align-items:center; gap:8px}
    .btn:focus{outline:3px solid rgba(10,132,255,.25); outline-offset:2px}
    .btn:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 10px 24px rgba(0,0,0,.06); border-color:#D5DEEA}
    .btn:active:not(:disabled){transform:translateY(0)}
    .btn:disabled{opacity:.55;cursor:not-allowed}
    .btn.primary{background:var(--accent);color:#fff;border-color:var(--accent)}
    .btn.success{background:var(--green);color:#fff;border-color:var(--green)}
    .btn.warning{background:var(--orange);color:#fff;border-color:var(--orange)}
    .spinner{width:14px;height:14px;border:2px solid rgba(255,255,255,.6);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    .statusbar{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:16px;color:var(--muted);font-size:12px}
    .pill{padding:4px 8px;border:1px dashed var(--stroke);border-radius:999px}

    .hero{background:#fff;border:1px solid var(--stroke);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow);margin-bottom:20px}
    .hero-title{font-size:var(--fs-xxl);font-weight:800;margin-bottom:6px}
    .subtext{color:var(--muted);margin-bottom:16px}
    textarea{width:100%;min-height:120px;padding:12px;border-radius:12px;border:1px solid var(--stroke);background:var(--surface-2);color:var(--ink)}

    .section h2{font-size:var(--fs-xl);margin:12px 0}
    .lanes{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .lane{background:linear-gradient(180deg,#FFFFFF 0%, #F8FAFF 70%, #FFFFFF 100%); border:1px solid var(--stroke); border-radius:16px; padding:12px; box-shadow:var(--shadow)}
    .lane h3{margin:0 0 8px 0;font-size:16px;color:#0B1220}
    .ourday-wrap{display:none}

    .skeleton{height:96px;border-radius:14px;background:linear-gradient(90deg,#f3f4f8 25%, #e9ecf4 37%, #f3f4f8 63%);background-size:400% 100%;animation:shimmer 1.2s infinite}
    @keyframes shimmer{0%{background-position:100% 0}100%{background-position:0 0}}
    .card{background:#fff;border:1px solid var(--stroke);border-radius:14px;box-shadow:var(--shadow);padding:14px;margin-bottom:10px}
    .card-header{display:flex;align-items:flex-start;gap:10px;margin-bottom:6px}
    .prio{width:8px;height:8px;border-radius:50%;margin-top:7px}
    .prio.red{background:var(--red)} .prio.orange{background:var(--orange)} .prio.green{background:var(--green)}
    .title{font-weight:700; font-size:var(--fs-m)}
    .meta-row{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);font-size:12px;margin:6px 0}
    details.rationale{margin-top:6px}
    details.rationale>summary{list-style:none; cursor:pointer; color:#0A84FF; font-size:12px}
    details.rationale>summary::-webkit-details-marker{display:none}
    .why{margin-top:6px;color:#334155;font-size:13px;background:#F8FAFF;padding:10px;border-radius:10px;border:1px solid #D7E3FF}
    .card-actions{margin-top:10px;display:flex;gap:6px;flex-wrap:wrap}

    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:18px;padding-top:12px;border-top:1px solid var(--stroke);color:var(--muted);font-size:13px}

    .toast{position:fixed;right:16px;bottom:16px;background:#0B1220;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 8px 20px rgba(0,0,0,.2);z-index:9999;font-size:13px;opacity:0;transition:opacity .2s;pointer-events:none}

    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;z-index:60}
    .modal[open]{display:flex}
    .modal-box{background:#fff;border:1px solid var(--stroke);border-radius:18px;padding:20px;max-width:920px;width:92%;box-shadow:var(--shadow);position:relative;max-height:82vh;overflow-y:auto}
    .modal-topbar{position:sticky;top:0;background:#fff;padding:6px 4px 8px;display:flex;gap:8px;justify-content:space-between;border-bottom:1px solid var(--stroke); z-index:2}
    .modal-close{border:1px solid var(--stroke);background:#fff;border-radius:10px;padding:6px 8px;cursor:pointer}

    .apps{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:10px;margin:12px 0}
    .app{border:1px solid var(--stroke);border-radius:12px;padding:12px;background:#FAFBFF;display:flex;flex-direction:column;gap:8px}
    .chip{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:4px 8px;font-size:12px;border:1px solid var(--stroke);}
    .chip.gray{background:#F6F7FB;color:#475467}
    .chip.blue{background:#E7F0FF;color:#1849A9;border-color:#C2DAFF}
    .chip.purple{background:#EEE9FF;color:#463AA8;border-color:#D5CCFF}
    .chip.green{background:#E8F5E8;color:#116A28;border-color:#CBEFD0}
    .meta{color:var(--muted);font-size:12px}

    .bar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:8px 0}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">ROM</div>
      <div class="actions">
        <button class="btn" id="connectBtn">Connect apps</button>
        <button class="btn" id="sampleBtn">Try sample tour</button>
      </div>
    </div>

    <div class="statusbar">
      <span class="pill" id="stat-index">Local index: 0 items</span>
      <span class="pill" id="stat-apps">0 apps auth’d</span>
      <span class="pill" id="stat-sync">Last sync: never</span>
      <span class="pill" id="stat-mode">Offline‑first</span>
    </div>

    <div class="hero">
      <div class="hero-title">Everyday AI</div>
      <div class="subtext">Paste a few messages or click sample. Cards show **why** and a **one‑tap Next Step** that routes you to the right app.</div>
      <textarea id="inbox" placeholder="Paste subjects, DMs, reminders — one per line."></textarea>
      <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
        <button class="btn primary" id="buildBtn"><span class="label">Organize</span></button>
        <button class="btn" id="clearBtn">Clear</button>
      </div>
    </div>

    <section class="section priority">
      <h2>Priority Dashboard</h2>
      <div class="lanes">
        <div class="lane"><h3>Now</h3><div id="lane-now"></div></div>
        <div class="lane"><h3>Soon</h3><div id="lane-soon"></div></div>
        <div class="lane"><h3>Waiting</h3><div id="lane-waiting"></div></div>
      </div>
    </section>

    <footer class="footer">
      <div>All local, no servers.</div>
      <div style="display:flex;gap:10px;align-items:center">
        <button class="btn" id="openCaps">Memory Capsules</button>
      </div>
    </footer>
  </div>

  <!-- Capsules Modal -->
  <div id="capsuleModal" class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <div class="modal-box">
      <div class="modal-topbar">
        <strong>Memory Capsules</strong>
        <div>
          <button class="btn" id="xCaps">✕</button>
        </div>
      </div>
      <div id="capsules"></div>
      <div class="bar" style="justify-content:flex-end;border-top:1px solid var(--stroke);padding-top:12px">
        <button class="btn success" id="exportCaps">Export JSON</button>
        <button class="btn warning" id="clearCaps">Clear All</button>
        <button class="btn" id="closeCaps">Close</button>
      </div>
    </div>
  </div>

  <!-- Connect Modal -->
  <div id="connectModal" class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <div class="modal-box">
      <div class="modal-topbar">
        <strong>Connect Apps</strong>
        <button class="btn" id="xConnect">✕</button>
      </div>
      <div class="apps" id="apps"></div>
      <div class="bar">
        <button class="btn" id="authBtn">Authenticate Selected</button>
        <button class="btn" id="indexBtn">Import Live Data</button>
        <button class="btn" id="writeBtn">Verify Write‑Back</button>
        <span class="meta" id="connMeta">Select one or more apps to begin.</span>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end"><button class="btn" id="closeConnect">Close</button></div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
  /* === Utilities === */
  const $ = s => document.querySelector(s);
  const $$ = s => [...document.querySelectorAll(s)];
  const store = { get(k, f){ try{ const v = localStorage.getItem(k); return v? JSON.parse(v): f; } catch{ return f; } }, set(k,v){ try{ localStorage.setItem(k, JSON.stringify(v)); } catch{} } };
  function toast(msg, t=2000){ const el=$('#toast'); el.textContent=msg; el.style.opacity='1'; el.style.display='block'; clearTimeout(toast._t); toast._t=setTimeout(()=>{el.style.opacity='0'; el.style.display='none';}, t); }
  function nowIso(){ return new Date().toISOString(); }

  /* === Connector state machine === */
  const DEFAULT_CONNECTORS = {
    google: { key:'google', name:'Google', selected:false, status:'not_connected', lastSync:null, records:0, writeReady:false, stages:['not_connected','authed','indexed','write_ready'] },
    slack:  { key:'slack',  name:'Slack',  selected:false, status:'not_connected', lastSync:null, records:0, writeReady:false, stages:['not_connected','authed','indexed','write_ready'] },
    notion: { key:'notion', name:'Notion', selected:false, status:'not_connected', lastSync:null, records:0, writeReady:false, stages:['not_connected','authed','indexed','write_ready'] },
    trello: { key:'trello', name:'Trello', selected:false, status:'not_connected', lastSync:null, records:0, writeReady:false, stages:['not_connected','authed','indexed','write_ready'] },
    files:  { key:'files',  name:'Local Files', selected:false, status:'not_connected', lastSync:null, records:0, writeReady:false, stages:['not_connected','indexed'] }
  };
  let CONNECTORS = store.get('rom_connectors', DEFAULT_CONNECTORS);
  function saveConnectors(){ store.set('rom_connectors', CONNECTORS); }

  function renderConnectors(){
    const box = $('#apps'); box.innerHTML='';
    Object.values(CONNECTORS).forEach(c => {
      const el = document.createElement('div'); el.className='app';
      const chip = statusChip(c.status);
      el.innerHTML = `
        <label style="display:flex;gap:8px;align-items:center">
          <input type="checkbox" ${c.selected? 'checked':''} data-k="${c.key}" aria-label="Select ${c.name}"/>
          <strong>${c.name}</strong>
          <span class="chip ${chip.cls}">${chip.text}</span>
        </label>
        <div class="meta">Last sync: ${c.lastSync? new Date(c.lastSync).toLocaleString(): 'never'} • ${c.records} items</div>
      `;
      el.querySelector('input').addEventListener('change', (e)=>{
        CONNECTORS[c.key].selected = e.target.checked; saveConnectors(); updateConnMeta();
      });
      box.appendChild(el);
    });
    updateConnMeta();
  }
  function statusChip(status){
    switch(status){
      case 'authed': return {text:'Auth’d', cls:'blue chip'};
      case 'indexed': return {text:'Indexed', cls:'purple chip'};
      case 'write_ready': return {text:'Write‑back Ready', cls:'green chip'};
      default: return {text:'Not Connected', cls:'gray chip'};
    }
  }
  function anySelected(){ return Object.values(CONNECTORS).some(c=>c.selected); }
  function anyAuthed(){ return Object.values(CONNECTORS).some(c=>c.status==='authed' || c.status==='indexed' || c.status==='write_ready'); }
  function anyIndexed(){ return Object.values(CONNECTORS).some(c=>c.status==='indexed' || c.status==='write_ready'); }
  function appsAuthedCount(){ return Object.values(CONNECTORS).filter(c=>c.status!=='not_connected').length; }

  function updateConnMeta(){
    const meta=$('#connMeta');
    const parts=[];
    parts.push(appsAuthedCount()+" app(s) in pipeline");
    if(!anySelected()) parts.push('Select apps');
    $('#authBtn').disabled = !anySelected();
    $('#indexBtn').disabled = !anyAuthed();
    $('#writeBtn').disabled = !anyIndexed();
    meta.textContent = parts.join(' • ');
  }

  /* === Fake flows (replace with real OAuth + API) === */
  function busy(btn, label){ const old=btn.innerHTML; btn.disabled=true; btn.innerHTML = `<span class="spinner"></span> ${label}`; return ()=>{ btn.disabled=false; btn.innerHTML = label.replace(/^[^ ]+\s/,''); } }
  async function authenticateSelected(){ const end = busy($('#authBtn'), ' Working…'); await sleep(700); Object.values(CONNECTORS).forEach(c=>{ if(c.selected){ c.status='authed'; } }); saveConnectors(); renderConnectors(); end(); toast('Authenticated'); }
  async function importLiveData(){ const end = busy($('#indexBtn'), ' Importing…'); await sleep(900); let total=0; Object.values(CONNECTORS).forEach(c=>{ if(c.status==='authed' || c.status==='indexed' || c.status==='write_ready'){ c.status='indexed'; c.lastSync=nowIso(); const n=Math.floor(Math.random()*30)+10; c.records+=n; total+=n; } }); saveConnectors(); renderConnectors(); bumpIndex(total); end(); toast(`Imported ${total} items`); }
  async function verifyWriteBack(){ const end = busy($('#writeBtn'), ' Verifying…'); await sleep(700); Object.values(CONNECTORS).forEach(c=>{ if(c.status==='indexed'){ c.status='write_ready'; c.writeReady=true; } }); saveConnectors(); renderConnectors(); end(); toast('Write‑back verified'); }
  const sleep = ms => new Promise(r=>setTimeout(r, ms));

  /* === Statusbar === */
  function bumpIndex(n){ const el=$('#stat-index'); const curr= parseInt((el.dataset.count||'0'),10); const next= curr + (n||0); el.dataset.count = String(next); el.textContent = `Local index: ${next} items`; $('#stat-apps').textContent = `${appsAuthedCount()} apps auth’d`; $('#stat-sync').textContent = `Last sync: ${new Date().toLocaleTimeString()}`; }

  /* === Task engine (demo heuristic with reasoning) === */
  function analyze(line){
    const lower=line.toLowerCase();
    const why=[]; let cat='general'; let prio='green';
    if(/urgent|asap|overdue|today|now/.test(lower)){ prio='red'; why.push('time‑sensitive'); }
    else if(/tomorrow|soon|friday|this week/.test(lower)){ prio='orange'; why.push('upcoming'); }
    if(/meeting|coffee|call|1:1|standup|lunch|dinner/.test(lower)){ cat='meeting'; why.push('meeting keyword'); }
    if(/invoice|payment|bill|budget|finance/.test(lower)){ cat='finance'; why.push('financial keyword'); }
    if(/review|approve|draft|edit|finalize|submit/.test(lower)){ cat='review'; why.push('review keyword'); }
    if(/[?]/.test(line)){ why.push('question'); }
    const origin = /gmail|email|re:/.test(lower)? 'Gmail' : /slack/.test(lower)? 'Slack' : /sms|text|imessage|whatsapp/.test(lower)? 'SMS' : 'Manual';
    const nextText = nextStep(cat, line);
    const route = routeAction({origin, cat, text: line});
    return { line, cat, prio, why, origin, nextText, route };
  }
  function nextStep(cat, text){
    switch(cat){
      case 'meeting': return 'Confirm time and add a hold to calendar';
      case 'finance': return 'Open invoice app and pay / follow up';
      case 'review': return 'Open the doc, review, then send a quick note';
      default: return 'Take the next concrete step';
    }
  }
  function routeAction({origin, cat, text}){
    const enc = encodeURIComponent(text.replace(/^re:\s*/i,''));
    if(origin==='SMS'){
      return { label:'Reply in Messages', href:`sms:&body=${encodeURIComponent(proposeReply(text))}` };
    }
    if(origin==='Slack'){
      return { label:'Open in Slack', href:'slack://open' };
    }
    if(origin==='Gmail'){
      return { label:'Draft in Gmail', href:`https://mail.google.com/mail/?view=cm&su=${enc}&body=${encodeURIComponent(proposeReply(text))}` };
    }
    if(cat==='meeting'){
      return { label:'Add to Google Calendar', href:`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${enc}&details=${enc}` };
    }
    if(cat==='finance'){
      return { label:'Open Invoice App', href:'https://app.qbo.intuit.com/app/homepage' };
    }
    return { label:'Copy reply', href:'#copy', payload:proposeReply(text) };
  }
  function proposeReply(text){
    const t=text.toLowerCase();
    if(/coffee|meet|lunch|dinner|call/.test(t)) return 'Sounds good — see you then. If anything changes, text me.';
    if(/review|draft|feedback|approve|look/.test(t)) return 'Got it — I’ll review now and follow up shortly.';
    if(/invoice|payment|overdue|bill/.test(t)) return 'Thanks — I’ll take care of the invoice and confirm once paid.';
    if(/[?]/.test(t)) return 'Thanks for the question — I’ll check and get back shortly.';
    return 'Noted — on it.';
  }

  function renderCards(lines){
    const L = { now: $('#lane-now'), soon: $('#lane-soon'), waiting: $('#lane-waiting') };
    Object.values(L).forEach(el=> el.innerHTML='');
    const items = lines.map(analyze);
    items.forEach((it, idx)=>{
      const card=document.createElement('div'); card.className='card';
      card.innerHTML = `
        <div class="card-header">
          <span class="prio ${it.prio}"></span>
          <div class="title">${escapeHtml(it.line)}</div>
        </div>
        <div class="meta-row">
          <span>${it.cat.toUpperCase()}</span>
          <span>${it.origin}</span>
          <details class="rationale"><summary>Why</summary><div class="why">${it.why.join(', ')||'Heuristics'}</div></details>
        </div>
        <div class="card-actions">
          <button class="btn primary action-btn"><span class="label">Next Step</span></button>
        </div>`;
      card.querySelector('.action-btn').addEventListener('click', (e)=> runAction(e.currentTarget, it.route));
      const lane = it.prio==='red'? L.now : it.prio==='orange'? L.soon : L.waiting;
      lane.appendChild(card);
    });
  }
  function escapeHtml(s){ return s.replace(/[&<>]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[c])); }
  async function runAction(btn, route){
    const end = buttonBusy(btn);
    await sleep(150);
    if(route.href==='#copy'){
      await navigator.clipboard.writeText(route.payload||''); toast('Reply copied'); end('Done'); return;
    }
    window.open(route.href, '_blank'); end('Opened');
  }
  function buttonBusy(btn){ const label=btn.querySelector('.label'); const old=label.textContent; btn.disabled=true; label.textContent='Working…'; const sp=document.createElement('span'); sp.className='spinner'; btn.prepend(sp); return (done='Done')=>{ btn.disabled=false; label.textContent=done; setTimeout(()=> label.textContent='Next Step', 900); sp.remove(); } }

  /* === Capsules === */
  function openCapsules(){ $('#capsules').innerHTML = `<div class="meta">No memory yet. Actions you run will be saved here with sources.</div>`; $('#capsuleModal').setAttribute('open',''); }

  /* === Sample tour === */
  const SAMPLE = [
    'Coffee with Alex tomorrow 10am (text)',
    'Invoice #1187 overdue 7 days — ACME',
    'Draft product page review before Friday (Notion)'
  ];

  /* === Event wiring === */
  document.addEventListener('DOMContentLoaded', ()=>{
    // Build
    $('#buildBtn').addEventListener('click', ()=>{
      const raw = $('#inbox').value.trim().split(/\n/).filter(Boolean);
      if(!raw.length) return toast('Paste something first');
      renderCards(raw); toast(`Organized ${raw.length} items`);
    });
    // Clear
    $('#clearBtn').addEventListener('click', ()=> $('#inbox').value='');
    // Sample tour
    $('#sampleBtn').addEventListener('click', ()=>{ $('#inbox').value = SAMPLE.join('\n'); toast('Loaded a guided sample. Press Organize.'); });

    // Capsules modal
    $('#openCaps').addEventListener('click', openCapsules);
    $('#xCaps').addEventListener('click', ()=> $('#capsuleModal').removeAttribute('open'));
    $('#closeCaps').addEventListener('click', ()=> $('#capsuleModal').removeAttribute('open'));
    $('#clearCaps').addEventListener('click', ()=>{ if(confirm('Clear all capsules?')){ toast('Cleared'); $('#capsules').innerHTML = '<div class="meta">No memory yet.</div>'; } });
    $('#exportCaps').addEventListener('click', ()=>{ const blob = new Blob([JSON.stringify({capsules:[]},null,2)], {type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='rom-capsules.json'; a.click(); toast('Exported'); });

    // Connect modal
    $('#connectBtn').addEventListener('click', ()=>{ renderConnectors(); $('#connectModal').setAttribute('open',''); });
    $('#xConnect').addEventListener('click', ()=> $('#connectModal').removeAttribute('open'));
    $('#closeConnect').addEventListener('click', ()=> $('#connectModal').removeAttribute('open'));
    $('#authBtn').addEventListener('click', authenticateSelected);
    $('#indexBtn').addEventListener('click', importLiveData);
    $('#writeBtn').addEventListener('click', verifyWriteBack);

    // Init statusbar from store
    bumpIndex(0); renderConnectors();
  });
  </script>
  <!-- SCRIPTS (place near end of <body>) -->
<script src="assets/js/api.js"></script>
<script src="assets/js/connectors.js" type="module"></script>
<script src="assets/js/digest.js" type="module"></script>
<script src="assets/js/chat.js" type="module"></script>
    
</body>
</html>


